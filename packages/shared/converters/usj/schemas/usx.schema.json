{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "USX Schema",
  "description": "JSON Schema for USX 3.0.7",
  "type": "object",
  "definitions": {
    "Para": {
      "oneOf": [{ "$ref": "#/definitions/VersePara" }, { "$ref": "#/definitions/OtherPara" }]
    },
    "VersePara": {
      "type": "object",
      "properties": {
        "para": {
          "type": "object",
          "properties": {
            "style": {
              "type": "string",
              "enum": [
                "cls",
                "nb",
                "pc",
                "pi1",
                "pi2",
                "pi3",
                "pi",
                "po",
                "pr",
                "pmo",
                "pmc",
                "pmr",
                "pm",
                "ph1",
                "ph2",
                "ph3",
                "ph",
                "p",
                "q1",
                "q2",
                "q3",
                "q4",
                "qc",
                "qr",
                "qm1",
                "qm2",
                "qm3",
                "qm",
                "qd",
                "q",
                "b",
                "d",
                "mi1",
                "mi2",
                "mi3",
                "mi4",
                "mi",
                "m"
              ],
              "description": "Style of verse paragraph"
            },
            "vid": {
              "type": "string",
              "pattern": "[A-Z1-4]{3} ?[a-z0-9\\-:]*(&#x200F;?[\\-,][0-9]+)*",
              "description": "Verse identifier"
            },
            "content": {
              "type": "array",
              "items": {
                "oneOf": [
                  { "type": "string" },
                  { "$ref": "#/definitions/CharEmbed" },
                  { "$ref": "#/definitions/Figure" },
                  { "$ref": "#/definitions/Milestone" },
                  { "$ref": "#/definitions/Verse" },
                  { "$ref": "#/definitions/Reference" },
                  { "$ref": "#/definitions/Footnote" },
                  { "$ref": "#/definitions/CrossReference" },
                  { "$ref": "#/definitions/Break" }
                ]
              }
            }
          },
          "required": ["style", "content"],
          "additionalProperties": false
        }
      },
      "required": ["para"]
    },
    "OtherPara": {
      "type": "object",
      "properties": {
        "para": {
          "type": "object",
          "properties": {
            "style": {
              "type": "string",
              "enum": ["lit", "cp", "pb", "qa", "k1", "k2", "sts", "rem"],
              "description": "Style of other paragraph"
            },
            "vid": {
              "type": "string",
              "pattern": "[A-Z1-4]{3} ?[a-z0-9\\-:]*(&#x200F;?[\\-,][0-9]+)*",
              "description": "Verse identifier"
            },
            "content": {
              "type": "array",
              "items": {
                "oneOf": [
                  { "type": "string" },
                  { "$ref": "#/definitions/Figure" },
                  { "$ref": "#/definitions/Milestone" },
                  { "$ref": "#/definitions/Reference" },
                  { "$ref": "#/definitions/Footnote" },
                  { "$ref": "#/definitions/CrossReference" },
                  { "$ref": "#/definitions/Break" }
                ]
              }
            }
          },
          "required": ["style", "content"],
          "additionalProperties": false
        }
      },
      "required": ["para"]
    },
    "CharEmbed": {
      "type": "object",
      "properties": {
        "char": {
          "type": "object",
          "properties": {
            "style": {
              "type": "string",
              "enum": [
                "vp",
                "qac",
                "qs",
                "add",
                "addpn",
                "bk",
                "dc",
                "efm",
                "fm",
                "fv",
                "k",
                "nd",
                "ndx",
                "ord",
                "png",
                "pn",
                "pro",
                "qt",
                "rq",
                "sig",
                "sls",
                "tl",
                "wg",
                "wh",
                "wa",
                "wj",
                "jmp",
                "no",
                "it",
                "bdit",
                "bd",
                "em",
                "sc",
                "sup",
                "xt",
                "w",
                "rb"
              ]
            },
            "closed": {
              "type": "boolean"
            },
            "content": {
              "type": "array",
              "items": {
                "oneOf": [
                  { "type": "string" },
                  { "$ref": "#/definitions/CharEmbed" },
                  { "$ref": "#/definitions/Figure" },
                  { "$ref": "#/definitions/Milestone" },
                  { "$ref": "#/definitions/Reference" },
                  { "$ref": "#/definitions/Break" }
                ]
              }
            }
          },
          "required": ["style", "content"]
        }
      },
      "required": ["char"]
    },
    "Figure": {
      "type": "object",
      "properties": {
        "figure": {
          "type": "object",
          "properties": {
            "style": {
              "const": "fig"
            },
            "alt": {
              "type": "string"
            },
            "src": {
              "type": "string"
            },
            "size": {
              "type": "string"
            },
            "loc": {
              "type": "string"
            },
            "copy": {
              "type": "string"
            },
            "ref": {
              "type": "string"
            }
          },
          "required": ["style"]
        }
      },
      "required": ["figure"]
    },
    "Milestone": {
      "type": "object",
      "properties": {
        "ms": {
          "type": "object",
          "properties": {
            "style": {
              "type": "string",
              "enum": [
                "ts-s",
                "ts-e",
                "ts",
                "t-s",
                "t-e",
                "qt1-s",
                "qt1-e",
                "qt2-s",
                "qt2-e",
                "qt3-s",
                "qt3-e",
                "qt4-s",
                "qt4-e",
                "qt5-s",
                "qt5-e",
                "qt-s",
                "qt-e"
              ]
            },
            "sid": {
              "type": "string"
            },
            "eid": {
              "type": "string"
            }
          },
          "required": ["style"]
        }
      },
      "required": ["ms"]
    },
    "Reference": {
      "type": "object",
      "properties": {
        "ref": {
          "type": "object",
          "properties": {
            "loc": {
              "type": "string",
              "pattern": "[A-Z1-4]{3}(-[A-Z1-4]{3})? ?[a-z0-9\\-:]*"
            },
            "gen": {
              "type": "boolean"
            }
          }
        }
      },
      "required": ["ref"]
    },
    "Break": {
      "type": "object",
      "properties": {
        "optbreak": {
          "type": "object"
        }
      },
      "required": ["optbreak"]
    }
  },
  "oneOf": [{ "$ref": "#/definitions/Para" }]
}
